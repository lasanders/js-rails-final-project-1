<H2>Purchase Reciept:</H2>



<%= form_tag("/purchases", method: "post") do %>
<%= hidden_field_tag :user_id, value = current_user.id %><br>
<%= hidden_field_tag :candy_id, value = @purchase.candy_id %>
<a href="#" class="js-next" data-id="<%=@purchase.id%>", data-user_id="<%=@purchase.user_id%>">Next Purchase</a>
<h3><%= @purchase.candy.name %></h3>
Cost of candy: <%= @purchase.candy.cost %> dollars<br>
Candy flavor: <%= @purchase.candy.taste %><br>
Candy appetite rating: <%= @purchase.candy.appetite %><br>
Payment Type: <%= @purchase.payment_type %><br>
<% end %>


<br></br>
<%= link_to 'Log Out', signout_path%>
<%= link_to 'See candies', candies_path %>
<%= link_to 'User Profile', user_path(@user) %>


<script type="text/javascript" charset="utf-8">
$(function () {
  $(".js-next").on("click", function() {
  var user_id = parseInt($(".js-next").attr("data-user_id"))
    var nextId = parseInt($(".js-next").attr("data-id")) + 1;
    debugger
    $.get("/users/" + user_id + "/purchases/" + nextId + ".json"), function(data) {
      for(let i = 0, l = data.items.length; i < l; i++) {
        var prop = data.items[i]
debugger
      $(".PurchaseCandyName").text(prop.candy.name);
      $(".PurchaseCandyTaste").text(prop.candy.taste);
      $(".PurchaseCandyAppetite").text(prop.candy.appetite);
      $(".PurchaseCandyCost").text(prop.candy.cost);
      $(".PurchaseCandyCount").text(prop.candy.count);
   $(".js-next").attr("data-id", prop.candy.id);
}
}
    });
  });
</script>
